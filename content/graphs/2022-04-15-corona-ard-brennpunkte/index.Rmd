---
title: Corona ARD Brennpunkte
author: ''
date: '2022-04-15'
slug: []
categories: []
tags: []
output:
  html_document:
    css: ["custom.css"]
---
```{r init, message=F, echo=F}
library(knitr)
knitr::opts_chunk$set(echo = FALSE,  message = F)
```

```{r package}
library(tidyverse)
library(gt)
library(here)
```

```{r dataload}
path = here("static", "data", "graphs","ardbrennpunkte", "data_corona.csv")
data = readr::read_csv(path)
```

```{r formatdata}
data %>% 
  rename(
    "Datum" = 1,
     "Thema" = 2,
    "Dauer" = 3,
    "Sprecher:In" = 4,
    "Sender" = 5,
    "Zuschauer:Innen" = 6,
    "Quote" = 7
  ) %>% 
  select(-c(Quellen)) %>% 
  mutate(
    Quote = sub("^(\\d{1,2},\\d{1}).*", "\\1", Quote),
    Quote = str_replace(Quote, ",", "\\.") %>% as.numeric()
  ) -> data


data = data %>% 
  mutate(
    Quote = ifelse(is.na(Quote), 0, Quote)
  )

```

<style>
.reactable{
  font-family: mono;
  font-size: 13px;
}
</style>

```{r gt}
library(reactable)
library(htmltools)

BuYlRd <- function(x) rgb(colorRamp(c("#7fb7d7", "#ffffbf", "#fc8d59"))(x), maxColorValue = 255)
Quote = data[["Quote"]]

data %>% reactable::reactable(.,
                              columns = list(Quote = colDef(
                                style = function(value) {
                                  if (!is.numeric(value))
                                    return()
                                  normalized <-
                                    (value - min(Quote)) / (max(Quote) - min(Quote))
                                  color <- BuYlRd(normalized)
                                  list(background = color)
                                },
                                format = colFormat(digits = 1),
                                minWidth = 50)
                              ))
```

